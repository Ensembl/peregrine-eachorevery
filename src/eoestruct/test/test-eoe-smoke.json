[
    [
        "smoke test1",
        ["!a","!b"],[],
        [
            1, 2,
            {
                "?a": [10,11],
                "!a": {
                    "?b": [20,21,22],
                    "!b": ["?a","?b",30]
                }
            }
        ],
        "[1.0,2.0,Aa.( Ab.( [a=<10.0,11.0>,b=<20.0,21.0,22.0>,30.0] ) )]",
        [
            1, 2, [[[10,20,30],[10,21,30],[10,22,30]],[[11,20,30],[11,21,30],[11,22,30]]]
        ],
        {}
    ],
    [
        "lates test1",
        ["!a","!b"],[],
        [
            1, 2,
            {
                "?a": null,
                "!a": {
                    "?b": [20,21,22],
                    "!b": ["?a","?b",30]
                }
            }
        ],
        "[1.0,2.0,Aa.( Ab.( [a=?,b=<20.0,21.0,22.0>,30.0] ) )]",
        [
            1, 2, [[[10,20,30],[10,21,30],[10,22,30]],[[11,20,30],[11,21,30],[11,22,30]]]
        ],
        {
            "?a": [10,11]
        }
    ],
    [
        "smoke test2",
        ["!ab"],[],
        [
            1,2,
            {
                "?a": [10,11,12],
                "?b": [20,21,22],
                "!ab": {
                    "a": "?a",
                    "b": "?b",
                    "c": 30
                }
            }
        ],
        "[1.0,2.0,Aab.( {\"a\": a=<10.0,11.0,12.0>,\"b\": b=<20.0,21.0,22.0>,\"c\": 30.0} )]",
        [
            1,2,[
                {"a":10, "b":20, "c": 30},
                {"a":11, "b":21, "c": 30},
                {"a":12, "b":22, "c": 30}
            ]
        ],
        {}
    ],
    [
        "repeat variable",
        ["!"],[],
        {
            "?a": [false,true,true],
            "!": [1,"?a","?a",[2,"?a"]]
        },
        "Aa.( [1.0,a=<false,true,true>,a=<false,true,true>,[2.0,a=<false,true,true>]] )",
        [
            [1,false,false,[2,false]],
            [1,true,true,[2,true]],
            [1,true,true,[2,true]]
        ],
        {}
    ],
    [
        "repeat variable 2",
        ["!a","!b"],[],
        {
            "?a": [false,true,true],
            "!a": [1,"?a",{
                "!b": [2,"?a","?b"],
                "?b": [7,8,9]
            }]
        },
        "Aa.( [1.0,a=<false,true,true>,Ab.( [2.0,a=<false,true,true>,b=<7.0,8.0,9.0>] )] )",
        [
            [1,false,[[2,false,7],[2,false,8],[2,false,9]]],
            [1,true,[[2,true,7],[2,true,8],[2,true,9]]],
            [1,true,[[2,true,7],[2,true,8],[2,true,9]]]
        ],
        {}
    ],
    [
        "unused binding 1",
        ["!"],[],
        {
            "?a": [1,2,3],
            "?b": [4,5,6],
            "!": "?a"
        },
        "Aab.( a=<1.0,2.0,3.0> )",
        [1,2,3],
        {}
    ],
    [
        "repeated binding 3",
        ["!a","!a"],["&a"],
        {
            "&a": [true,true,false],
            "!a": [
                1,
                { "&a": [2, {
                    "&a": [false,true,false],
                    "!a": [{"&a": 3}]
                }] }
            ]
        },
        "Aa.( [1.0,Q[a=<true,true,false>] ([2.0,Ab.( [Q[b=<false,true,false>] (3.0 )] )] )] )",
        [
            [1,[2,[[],[3],[]]]],
            [1,[2,[[],[3],[]]]],
            [1]
        ],
        {}
    ],
    [
        "length zero bottom",
        ["!a","!b"],[],
        {
            "?a": [false,true,true],
            "!a": [1,"?a",{
                "!b": [2,"?a","?b"],
                "?b": []
            }]
        },
        "Aa.( [1.0,a=<false,true,true>,Ab.( [2.0,a=<false,true,true>,b=<>] )] )",
        [
            [1,false,[]],
            [1,true,[]],
            [1,true,[]]
        ],
        {}
    ],
    [
        "length zero top",
        ["!a","!b"],[],
        {
            "?a": [],
            "!a": [1,"?a",{
                "!b": [2,"?a","?b"],
                "?b": [7,8,9]
            }]
        },
        "Aa.( [1.0,a=<>,Ab.( [2.0,a=<>,b=<7.0,8.0,9.0>] )] )",
        [],
        {}
    ],
    [
        "repeated binding 1",
        ["!a"],[],
        {
            "?a": [1,2],
            "!a": [
                "?a",
                {
                    "?a": [3,4],
                    "!a": [5,"?a"]
                }
            ]
        },
        "Aa.( [a=<1.0,2.0>,Ab.( [5.0,b=<3.0,4.0>] )] )",
        [
            [1,[[5,3],[5,4]]],
            [2,[[5,3],[5,4]]]
        ],
        {}
    ],
    [
        "repeated binding 2",
        ["!a"],[],
        {
            "?a": [1,2],
            "?b": [7,8],
            "!a": [
                {
                    "?a": [3,4],
                    "!a": ["?b","?a"]
                },
                "?a"
            ]
        },
        "Aab.( [Ac.( [b=<7.0,8.0>,c=<3.0,4.0>] ),a=<1.0,2.0>] )",
        [
            [[[7,3],[7,4]],1],
            [[[8,3],[8,4]],2]
        ],
        {}
    ],
    [
        "no variables",
        ["!"],[],
        {
            "!": [3]
        },
        "A.( [3.0] )",
        [[3]],
        {}
    ],
    [
        "condition smoke",
        ["!a"],["&a"],
        {
            "&a": [false,false,true,true,false],
            "!a": [
                1,
                2,
                { "&a": 3 }
            ]
        },
        "Aa.( [1.0,2.0,Q[a=<false,false,true,true,false>] (3.0 )] )",
        [
            [1,2],
            [1,2],
            [1,2,3],
            [1,2,3],
            [1,2]
        ],
        {}
    ],
    [
        "condition obj smoke",
        ["!a"],["&a"],
        {
            "&a": [false,false,true,true,false],
            "!a": {
                "a": 1,
                "b": 2,
                "c": { "&a": 3 }
            }
        },
        "Aa.( {\"a\": 1.0,\"b\": 2.0,\"c\": Q[a=<false,false,true,true,false>] (3.0 )} )",
        [
            {"a": 1, "b":2 },
            {"a": 1, "b":2 },
            {"a": 1, "b":2, "c": 3 },
            {"a": 1, "b":2, "c": 3 },
            {"a": 1, "b":2 }
        ],
        {}
    ]
]
