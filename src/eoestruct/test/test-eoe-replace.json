[
    [
        "replace smoke test1",
        ["!a","!b"],[],
        [
            1, 2,
            {
                "?a": [10,11],
                "!a": {
                    "?b": [20,21,22],
                    "!b": ["?a","?b",30]
                }
            }
        ],
        "[1.0,2.0,Aa.( Ab.( [a=<10.0,11.0>,b=<20.0,21.0,22.0>,30.0] ) )]",
        ["2","*","*","2"],
        99,
        [],
        "[1.0,2.0,Aa.( Ab.( [a=<10.0,11.0>,b=<20.0,21.0,22.0>,99.0] ) )]",
        [
            1, 2, [[[10,20,99],[10,21,99],[10,22,99]],[[11,20,99],[11,21,99],[11,22,99]]]
        ]
    ],
    [
        "replace root",
        ["!a","!b"],["&a"],
        [
            1, 2,
            {
                "?a": [10,11],
                "!a": {
                    "?b": [20,21,22],
                    "!b": ["?a","?b",30]
                }
            }
        ],
        "[1.0,2.0,Aa.( Ab.( [a=<10.0,11.0>,b=<20.0,21.0,22.0>,30.0] ) )]",
        [],
        {
            "?a": [1,2,3,4,5],
            "&a": [false,false,true,true,false],
            "!a": {
                "one": 1,
                "two": "?a",
                "three": { "&a": 3 }
            }
        },
        [],
        "Aab.( {\"one\": 1.0,\"three\": Q[a=<false,false,true,true,false>] (3.0 ),\"two\": b=<1.0,2.0,3.0,4.0,5.0>} )",
        [
            {"one": 1, "two": 1 },
            {"one": 1, "two": 2 },
            {"one": 1, "two": 3, "three": 3 },
            {"one": 1, "two": 4, "three": 3 },
            {"one": 1, "two": 5 }
        ]
    ],
    [
        "replace copy smoke test1",
        ["!a","!b"],[],
        [
            1, 2,
            {
                "?a": [10,11],
                "!a": {
                    "?b": [20,21,22],
                    "!b": ["?a","?b",30]
                }
            }
        ],
        "[1.0,2.0,Aa.( Ab.( [a=<10.0,11.0>,b=<20.0,21.0,22.0>,30.0] ) )]",
        ["2","*","*"],
        [false,false,99],
        [
            [["2","*","*","0"],["1"]],
            [["2","*","*","1"],["0"]]
        ],
        "[1.0,2.0,Aa.( Ab.( [b=<20.0,21.0,22.0>,a=<10.0,11.0>,99.0] ) )]",
        [
            1, 2, [[[20,10,99],[21,10,99],[22,10,99]],[[20,11,99],[21,11,99],[22,11,99]]]
        ]
    ],
    [
        "condition replace outer",
        ["!a"],["&a"],
        {
            "?a": [1,2,3,4,5],
            "&a": [false,false,true,true,false],
            "!a": [
                1,
                "?a",
                { "&a": 3 }
            ]
        },
        "Aab.( [1.0,b=<1.0,2.0,3.0,4.0,5.0>,Q[a=<false,false,true,true,false>] (3.0 )] )",
        ["*","2"],
        4,
        [],
        "Aab.( [1.0,b=<1.0,2.0,3.0,4.0,5.0>,4.0] )",
        [
            [1,1,4],
            [1,2,4],
            [1,3,4],
            [1,4,4],
            [1,5,4]
        ]
    ],
    [
        "condition replace inner",
        ["!a"],["&a"],
        {
            "?a": [1,2,3,4,5],
            "&a": [false,false,true,true,false],
            "!a": [
                1,
                "?a",
                { "&a": 3 }
            ]
        },
        "Aab.( [1.0,b=<1.0,2.0,3.0,4.0,5.0>,Q[a=<false,false,true,true,false>] (3.0 )] )",
        ["*","2","&"],
        4,
        [],
        "Aab.( [1.0,b=<1.0,2.0,3.0,4.0,5.0>,Q[a=<false,false,true,true,false>] (4.0 )] )",
        [
            [1,1],
            [1,2],
            [1,3,4],
            [1,4,4],
            [1,5]
        ]
    ],
    [
        "replace non-existent array1",
        ["!a","!b"],[],
        [
            1, 2,
            {
                "?a": [10,11],
                "!a": {
                    "?b": [20,21,22],
                    "!b": ["?a","?b",30]
                }
            }
        ],
        "[1.0,2.0,Aa.( Ab.( [a=<10.0,11.0>,b=<20.0,21.0,22.0>,30.0] ) )]",
        ["4"],
        99,
        [],
        "bad path"
    ],
    [
        "replace non-existent array2",
        ["!a","!b"],[],
        [
            1, 2,
            {
                "?a": [10,11],
                "!a": {
                    "?b": [20,21,22],
                    "!b": ["?a","?b",30]
                }
            }
        ],
        "[1.0,2.0,Aa.( Ab.( [a=<10.0,11.0>,b=<20.0,21.0,22.0>,30.0] ) )]",
        ["x"],
        99,
        [],
        "bad path"
    ],
    [
        "replace non-existent obj",
        ["!a"],["&a"],
        {
            "?a": [1,2,3,4,5],
            "&a": [false,false,true,true,false],
            "!a": {
                "one": 1,
                "two": "?a",
                "three": { "&a": 3 }
            }
        },
        "Aab.( {\"one\": 1.0,\"three\": Q[a=<false,false,true,true,false>] (3.0 ),\"two\": b=<1.0,2.0,3.0,4.0,5.0>} )",
        ["*","four"],
        99,
        [],
        "bad path"
    ],
    [
        "replace bad all",
        ["!a"],["&a"],
        {
            "?a": [1,2,3,4,5],
            "&a": [false,false,true,true,false],
            "!a": {
                "one": 1,
                "two": "?a",
                "three": { "&a": 3 }
            }
        },
        "Aab.( {\"one\": 1.0,\"three\": Q[a=<false,false,true,true,false>] (3.0 ),\"two\": b=<1.0,2.0,3.0,4.0,5.0>} )",
        ["xxx"],
        99,
        [],
        "bad path"
    ],
    [
        "replace bad condition",
        ["!a"],["&a"],
        {
            "?a": [1,2,3,4,5],
            "&a": [false,false,true,true,false],
            "!a": {
                "one": 1,
                "two": "?a",
                "three": { "&a": 3 }
            }
        },
        "Aab.( {\"one\": 1.0,\"three\": Q[a=<false,false,true,true,false>] (3.0 ),\"two\": b=<1.0,2.0,3.0,4.0,5.0>} )",
        ["*","three","0"],
        99,
        [],
        "bad path"
    ]
]
